:root {
  --bg:      #f4f3f0;
  --surface: #ffffff;
  --surf2:   #f9f8f6;
  --surf3:   #eeecea;
  --border:  #e0ddd8;
  --text:    #1a1814;
  --sub:     #8a8680;
  --accent:  #5b52e8;
  --acc-lt:  rgba(91,82,232,0.10);
  --green:   #16a35a;
  --grn-lt:  rgba(22,163,90,0.10);
  --amber:   #c47a0a;
  --amb-lt:  rgba(196,122,10,0.10);
  --red:     #dc2626;
  --red-lt:  rgba(220,38,38,0.10);
  --radius:  14px;
  --sidebar-w: 128px;
  --shadow:  0 1px 4px rgba(0,0,0,0.08), 0 4px 16px rgba(0,0,0,0.05);
  --h-topbar:  57px;
  --h-datebar: 43px;
  --h-taskhdr: 40px;
}
body.dark {
  --bg:      #0f0f13;
  --surface: #17171d;
  --surf2:   #1e1e26;
  --surf3:   #25252f;
  --border:  #2e2e3a;
  --text:    #f0eee8;
  --sub:     #7a7890;
  --accent:  #6c63ff;
  --acc-lt:  rgba(108,99,255,0.15);
  --green:   #22d07a;
  --grn-lt:  rgba(34,208,122,0.12);
  --amber:   #f5a623;
  --amb-lt:  rgba(245,166,35,0.12);
  --red:     #ff5b5b;
  --red-lt:  rgba(255,91,91,0.12);
  --shadow:  0 1px 4px rgba(0,0,0,0.3), 0 4px 16px rgba(0,0,0,0.2);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;font-size:14px;line-height:1.5;overflow-x:hidden;overflow-y:auto;-webkit-tap-highlight-color:transparent;}
body.modal-open{overflow:hidden;}

/* TOPBAR */
.topbar{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;}
.logo{font-family:'Syne',sans-serif;font-weight:800;font-size:15px;letter-spacing:0.5px;}
.logo span{color:var(--accent);}
.topbar-right{display:flex;align-items:center;gap:8px;}

/* SYNC INDICATOR */
.sync-indicator{display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:20px;background:var(--surf2);border:1px solid var(--border);font-size:10px;font-weight:700;color:var(--sub);letter-spacing:0.04em;transition:all 0.3s;}
.sync-dot{width:7px;height:7px;border-radius:50%;background:var(--sub);flex-shrink:0;transition:background 0.3s;}
.sync-indicator.connected .sync-dot{background:var(--green);}
.sync-indicator.connected{color:var(--green);border-color:rgba(22,163,90,0.3);background:var(--grn-lt);}
.sync-indicator.error .sync-dot{background:var(--red);}
.sync-indicator.error{color:var(--red);border-color:rgba(220,38,38,0.3);background:var(--red-lt);}
.sync-indicator.syncing .sync-dot{background:var(--amber);animation:syncPulse 0.8s ease-in-out infinite;}
.sync-indicator.syncing{color:var(--amber);}
@keyframes syncPulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:0.4;transform:scale(0.7);}}

.role-btn{font-family:'Outfit',sans-serif;font-size:11px;font-weight:700;letter-spacing:0.06em;text-transform:uppercase;padding:6px 14px;border-radius:20px;border:none;cursor:pointer;transition:opacity 0.15s,background 0.15s,color 0.15s;}
.role-btn.admin{background:var(--accent);color:#fff;}
.role-btn.admin-active{background:var(--accent);color:#fff;max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.role-btn.user{background:var(--green);color:#0f1a12;}
.role-btn:hover{opacity:0.85;}
.role-btn.logout{background:var(--red-lt);color:var(--red);border:1.5px solid var(--red);width:32px;height:32px;padding:0;display:inline-flex;align-items:center;justify-content:center;border-radius:50%;}
.role-btn.logout:hover{background:var(--red);color:#fff;opacity:1;}
.admin-tag{display:none!important;}
.role-btn.admin-active{
  display:inline-flex;align-items:center;gap:5px;font-size:11px;font-weight:700;
  padding:6px 13px;border-radius:20px;border:none;background:var(--accent);color:#fff;
  cursor:pointer;white-space:nowrap;max-width:180px;overflow:hidden;text-overflow:ellipsis;transition:opacity 0.15s;
}
.role-btn.admin-active:hover{opacity:0.85;}
.role-btn.admin-active.admin-kandiaru{background:rgba(139,92,246,0.15);color:#a78bfa;border:1.5px solid #8b5cf6;}
body.dark .role-btn.admin-active.admin-kandiaru{background:rgba(139,92,246,0.2);color:#c4b5fd;border-color:#a78bfa;}

/* FOOTER CREATOR CHIP */
.footer-creator{font-size:10px;font-weight:700;letter-spacing:0.03em;color:var(--sub);background:var(--surf3);border:none;padding:3px 9px;border-radius:20px;display:inline-flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0;}
.footer-creator svg{width:10px;height:10px;}
.footer-creator.chip-kandiaru{color:#a78bfa;background:rgba(139,92,246,0.10);border:none;}
body.dark .footer-creator.chip-kandiaru{color:#c4b5fd;background:rgba(139,92,246,0.15);border:none;}
.footer-creator.chip-francy,.footer-creator.chip-carina{color:var(--sub);background:var(--surf3);border:none;}

/* NOTE AUTHOR CHIP */
.note-author{font-size:10px;font-weight:700;color:var(--amber);background:var(--amb-lt);padding:2px 7px;border-radius:20px;display:flex;align-items:center;gap:3px;border:none;}
.note-author svg{width:9px;height:9px;}
.note-author.chip-kandiaru,.note-author.chip-francy,.note-author.chip-carina{color:var(--amber);background:var(--amb-lt);border:none;}

/* DATE BAR */
.date-bar{display:flex;align-items:center;justify-content:space-between;padding:6px 12px;background:var(--surface);border-bottom:1px solid var(--border);font-size:12px;font-weight:600;color:var(--sub);letter-spacing:0.05em;position:sticky;top:var(--h-topbar);z-index:99;}
.date-bar-center{flex:1;text-align:center;}
.date-bar-center span{color:var(--text);}
.date-bar-side{display:flex;align-items:center;gap:6px;width:auto;}
.date-bar-side.right{justify-content:flex-end;}
.icon-bar{width:30px;height:30px;border-radius:9px;border:1px solid var(--border);background:var(--surf2);display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--sub);transition:all 0.15s;flex-shrink:0;}
.icon-bar:hover{border-color:var(--accent);color:var(--accent);background:var(--acc-lt);}

/* APP BODY */
.app-body{display:flex;flex-direction:column;min-height:calc(100vh - 96px);}

/* TOP PANEL */
.top-panel{display:flex;border-bottom:1px solid var(--border);flex-shrink:0;height:255px;}

/* SIDEBAR */
.sidebar{width:var(--sidebar-w);flex-shrink:0;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;gap:6px;padding:12px 8px;}
.filter-btn{display:flex;align-items:center;gap:7px;padding:9px 10px;border-radius:10px;background:var(--surf2);border:1.5px solid transparent;font-family:'Outfit',sans-serif;font-size:12px;font-weight:600;color:var(--sub);cursor:pointer;transition:background 0.15s,color 0.15s,border-color 0.15s;text-align:left;width:100%;}
.f-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.f-all      .f-dot{background:var(--accent);}
.f-soon     .f-dot{background:var(--amber);}
.f-today    .f-dot{background:#ea6b0e;}
.f-overdue  .f-dot{background:var(--red);}
.f-done     .f-dot{background:var(--green);}
.filter-btn:hover{background:var(--surf3);color:var(--text);}
.filter-btn.active.f-all    {background:var(--acc-lt);border-color:var(--accent);color:var(--accent);}
.filter-btn.active.f-soon   {background:var(--amb-lt);border-color:var(--amber);color:var(--amber);}
.filter-btn.active.f-today  {background:rgba(234,107,14,0.10);border-color:#ea6b0e;color:#ea6b0e;}
.filter-btn.active.f-overdue{background:var(--red-lt);border-color:var(--red);color:var(--red);}
.filter-btn.active.f-done   {background:var(--grn-lt);border-color:var(--green);color:var(--green);}
.f-cancelled .f-dot {
  background: #6b7280;
}

.filter-btn.active.f-cancelled {
  background: rgba(107, 116, 128, 0.12);
  border-color: #6b7280;
  color: #6b7280;
}

body.dark .filter-btn.active.f-cancelled {
  background: rgba(107, 116, 128, 0.18);
  color: #9ca3af;
  border-color: #9ca3af;
}

@keyframes overdueGlow{0%,100%{box-shadow:0 0 0 0 rgba(220,38,38,0);background:var(--surf2);}50%{box-shadow:0 0 0 4px rgba(220,38,38,0.18),0 0 14px rgba(220,38,38,0.22);background:var(--red-lt);}}
.f-overdue.has-overdue{animation:overdueGlow 2s ease-in-out infinite;border-color:rgba(220,38,38,0.35)!important;color:var(--red)!important;}
.f-overdue.has-overdue .f-dot{background:var(--red);animation:none;}
.f-overdue.has-overdue .filter-count{background:var(--red);color:#fff;}
.filter-count{margin-left:auto;font-size:10px;font-weight:700;background:var(--surf3);color:var(--sub);padding:1px 6px;border-radius:20px;}
.filter-btn.active .filter-count{background:rgba(0,0,0,0.10);color:inherit;}
body.dark .filter-btn.active .filter-count{background:rgba(255,255,255,0.12);}

/* FEATURED */
.featured-panel{flex:1;background:var(--surface);padding:12px 14px;overflow-y:auto;display:flex;flex-direction:column;gap:6px;}
.featured-label{font-family:'Syne',sans-serif;font-size:10px;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;color:var(--sub);margin-bottom:2px;}
.note-card{background:linear-gradient(135deg,rgba(255,214,0,0.10),rgba(255,180,0,0.06));border:1px solid rgba(196,122,10,0.25);border-left:3px solid var(--amber);border-radius:10px;padding:10px 12px;position:relative;box-shadow:0 1px 6px rgba(196,122,10,0.08);}
body.dark .note-card{background:rgba(245,166,35,0.07);border-color:rgba(245,166,35,0.2);}
.note-card-top{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;margin-bottom:5px;}
.note-card-text{font-size:12px;color:var(--text);line-height:1.55;word-break:break-word;overflow-wrap:anywhere;flex:1;}
.note-del-btn{width:20px;height:20px;border-radius:6px;border:none;background:transparent;color:var(--sub);cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all 0.15s;padding:0;}
.note-del-btn:hover{background:var(--red-lt);color:var(--red);}
.note-card-meta{display:flex;align-items:center;gap:6px;margin-top:6px;}
.add-note-btn{display:none;align-items:center;gap:5px;padding:6px 11px;border-radius:8px;border:1.5px dashed var(--amber);background:transparent;font-family:'Outfit',sans-serif;font-size:11px;font-weight:700;color:var(--amber);cursor:pointer;transition:all 0.15s;width:fit-content;}
.add-note-btn:hover{background:var(--amb-lt);}
.add-note-btn.visible{display:flex;}
.feat-section-divider{display:flex;align-items:center;gap:6px;margin:2px 0;}
.feat-section-divider-line{flex:1;height:1px;background:var(--border);}
.feat-section-divider-label{font-family:'Syne',sans-serif;font-size:9px;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;color:var(--sub);white-space:nowrap;}
.featured-card{background:var(--surf2);border:1px solid var(--border);border-radius:10px;padding:11px 13px;cursor:pointer;transition:background 0.15s,transform 0.15s;border-left:3px solid var(--accent);box-shadow:var(--shadow);}
.featured-card:hover{background:var(--surf3);transform:translateX(2px);}
.featured-card.urgent{border-left-color:var(--red);}
.featured-card.soon{border-left-color:var(--amber);}
.fc-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;}
.fc-name{font-size:13px;font-weight:600;color:var(--text);}
.fc-meta{font-size:11px;color:var(--sub);display:flex;align-items:center;gap:5px;}
.due-dot{width:5px;height:5px;border-radius:50%;background:var(--red);display:inline-block;}
.no-featured{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--sub);gap:6px;text-align:center;}
.no-featured svg{opacity:0.2;}
.no-featured p{font-size:11px;}

/* ALL TASK HEADER */
.all-task-header{display:flex;align-items:center;padding:9px 16px;background:var(--surface);border-bottom:1px solid var(--border);border-top:1px solid var(--border);flex-shrink:0;gap:8px;position:sticky;top:calc(var(--h-topbar) + var(--h-datebar));z-index:90;}
.all-task-title{font-family:'Syne',sans-serif;font-size:12px;font-weight:800;letter-spacing:0.08em;text-transform:uppercase;white-space:nowrap;}
.task-count-badge{background:var(--accent);color:#fff;font-size:10px;font-weight:700;padding:2px 7px;border-radius:20px;}
.header-right{display:flex;align-items:center;gap:6px;margin-left:auto;}
.search-btn{width:30px;height:30px;border-radius:8px;border:1.5px solid var(--border);background:var(--surf2);display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--sub);transition:all 0.15s;}
.search-btn:hover{border-color:var(--accent);color:var(--accent);}
.add-task-btn{font-family:'Outfit',sans-serif;font-size:12px;font-weight:700;letter-spacing:0.04em;padding:7px 14px;border-radius:20px;border:1.5px solid var(--accent);background:var(--accent);color:#fff;cursor:pointer;transition:all 0.15s;white-space:nowrap;}
.add-task-btn:hover{opacity:0.85;}
.search-bar{display:none;padding:0 16px 10px;background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:calc(var(--h-topbar) + var(--h-datebar) + var(--h-taskhdr));z-index:89;}
.search-bar.open{display:block;}
.search-input{width:100%;background:var(--surf2);border:1px solid var(--border);border-radius:8px;padding:8px 12px;font-family:'Outfit',sans-serif;font-size:13px;color:var(--text);outline:none;transition:border-color 0.15s;}
.search-input:focus{border-color:var(--accent);}
.search-input::placeholder{color:var(--sub);}

/* TASK LIST AREA */
.task-area{padding:12px 14px;display:flex;flex-direction:column;gap:10px;}

/* DONE SECTION DIVIDER */
.done-divider{display:flex;align-items:center;gap:10px;padding:4px 0 2px;color:var(--sub);}
.done-divider-line{flex:1;height:1px;background:var(--border);}
.done-divider-label{font-family:'Syne',sans-serif;font-size:10px;font-weight:700;letter-spacing:0.1em;text-transform:uppercase;}

/* TASK CARD */
.task-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;overflow:hidden;transition:border-color 0.2s,box-shadow 0.2s;animation:fadeUp 0.22s ease;box-shadow:var(--shadow);min-width:0;width:100%;contain:layout style;}
.task-card:hover{border-color:var(--accent);box-shadow:0 4px 20px rgba(0,0,0,0.10);}
.task-card.expanded{border-color:var(--accent);box-shadow:0 0 0 2px var(--accent);}
.task-card.done-card{opacity:0.52;}
@keyframes fadeUp{from{opacity:0;transform:translateY(5px);}to{opacity:1;transform:translateY(0);}}

/* TOP ROW */
.card-top{display:flex;align-items:center;gap:10px;padding:13px 14px 10px;}
.card-name{flex:1;min-width:0;font-size:14px;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-break:break-word;}
.task-card.done-card .card-name{text-decoration:line-through;color:var(--sub);}
.task-card.cancelled-card {
  opacity: 0.55;
  background: var(--surf2);
  border-color: #6b7280 !important;
  border-left: 3px solid #6b7280 !important;
}

/* Strikethrough name — matches done-card behaviour */
.task-card.cancelled-card .card-name {
  text-decoration: line-through;
  text-decoration-thickness: 1.5px;
  color: var(--sub);
}

/* Mute the description preview */
.task-card.cancelled-card .card-desc-collapsed {
  opacity: 0.6;
}

/* Mute the due date row */
.task-card.cancelled-card .card-due-meta {
  opacity: 0.5;
}
.card-due-meta{display:flex;align-items:center;gap:5px;padding:0 14px 8px;font-size:12px;color:var(--sub);}
.card-due-meta svg{flex-shrink:0;position:relative;top:0;vertical-align:middle;}

/* BADGES */
.badge{font-size:10px;font-weight:700;padding:3px 9px;border-radius:20px;white-space:nowrap;flex-shrink:0;}
.cat-quiz      {background:#ede9fe;color:#5b21b6;}
.cat-project   {background:#dbeafe;color:#1e40af;}
.cat-assignment{background:#fce7f3;color:#9d174d;}
.cat-exam      {background:#fee2e2;color:#991b1b;}
.cat-study     {background:#d1fae5;color:#065f46;}
.cat-review    {background:#a7f3d0;color:#064e3b;}
.cat-output    {background:#fef3c7;color:#78350f;}
.cat-online    {background:#e0f2fe;color:#075985;}
.cat-other     {background:#f1f5f9;color:#475569;}
.cat-info      {background:#e0f2fe;color:#0369a1;}
.cat-fees      {background:#fef9c3;color:#854d0e;}
.cat-suspension{background:#fde8d8;color:#9a3412;}
.cat-noclasses {background:#f0fdf4;color:#166534;}
.cat-event     {background:#fdf4ff;color:#7e22ce;}
.cat-fillup    {background:#fff7ed;color:#c2410c;}
.cat-learning  {background:#ecfdf5;color:#047857;}
body.dark .cat-quiz      {background:rgba(109,40,217,0.22);color:#a78bfa;}
body.dark .cat-project   {background:rgba(29,78,216,0.22);color:#60a5fa;}
body.dark .cat-assignment{background:rgba(190,24,93,0.22);color:#f472b6;}
body.dark .cat-exam      {background:rgba(185,28,28,0.22);color:#fca5a5;}
body.dark .cat-study     {background:rgba(6,95,70,0.22);color:#34d399;}
body.dark .cat-review    {background:rgba(5,150,105,0.22);color:#6ee7b7;}
body.dark .cat-output    {background:rgba(133,77,14,0.22);color:#fcd34d;}
body.dark .cat-online    {background:rgba(3,105,161,0.22);color:#7dd3fc;}
body.dark .cat-other     {background:rgba(90,100,116,0.22);color:#94a3b8;}
body.dark .cat-info      {background:rgba(3,105,161,0.22);color:#7dd3fc;}
body.dark .cat-fees      {background:rgba(133,77,14,0.22);color:#fde68a;}
body.dark .cat-suspension{background:rgba(154,52,18,0.25);color:#fb923c;}
body.dark .cat-noclasses {background:rgba(6,95,70,0.2);color:#6ee7b7;}
body.dark .cat-event     {background:rgba(126,34,206,0.22);color:#d8b4fe;}
body.dark .cat-fillup    {background:rgba(194,65,12,0.22);color:#fdba74;}
body.dark .cat-learning  {background:rgba(4,120,87,0.22);color:#6ee7b7;}

.task-card.overdue-card{border-color:var(--red)!important;}
.task-card.overdue-card:hover{border-color:var(--red)!important;box-shadow:0 4px 20px rgba(220,38,38,0.18);}

/* STATUS CHIPS */
.status-chip{font-size:10px;font-weight:800;padding:2px 8px;border-radius:20px;letter-spacing:0.04em;text-transform:uppercase;white-space:nowrap;}
.status-chip.overdue{background:var(--red-lt);color:var(--red);}
.status-chip.today  {background:rgba(234,107,14,0.12);color:#ea6b0e;}
.status-chip.soon   {background:var(--amb-lt);color:var(--amber);}
.status-chip.done   {background:var(--grn-lt);color:var(--green);}
.status-chip.cancelled {
  background: rgba(107, 116, 128, 0.12);
  color: #6b7280;
}
body.dark .status-chip.cancelled {
  background: rgba(107, 116, 128, 0.18);
  color: #9ca3af;
}
body.dark .status-chip.today{background:rgba(234,107,14,0.18);color:#fb923c;}

/* CARD DESC */
.card-desc-collapsed{margin:0 14px 10px;background:var(--surf3);border-radius:8px;padding:9px 11px;cursor:pointer;font-size:12px;color:var(--sub);line-height:1.55;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;transition:background 0.15s;border:1px solid transparent;word-break:break-all;overflow-wrap:anywhere;}
.card-desc-collapsed:hover{background:var(--border);color:var(--text);border-color:var(--accent);}
.card-desc-collapsed.no-desc{font-style:italic;opacity:0.6;}

/* CARD FOOTER */
.card-footer{display:flex;align-items:center;padding:0 14px 12px;gap:8px;}
.cfb{font-family:'Outfit',sans-serif;font-size:11px;font-weight:700;letter-spacing:0.04em;text-transform:uppercase;padding:5px 12px;border-radius:6px;border:1.5px solid var(--border);background:transparent;color:var(--sub);cursor:pointer;transition:all 0.15s;}
.cfb:hover{background:var(--surf3);color:var(--text);}
.cfb.view{border-radius:8px;border-color:var(--accent);color:var(--accent);padding:0;width:30px;height:30px;display:inline-flex;align-items:center;justify-content:center;}
.cfb.view:hover{background:var(--acc-lt);}
.cfb.mark-done{border-radius:20px;border-color:var(--green);color:var(--green);padding:5px 16px;}
.cfb.mark-done:hover{background:var(--grn-lt);}
.cfb.undo-done{border-radius:20px;border-color:var(--amber);color:var(--amber);padding:5px 16px;}
.cfb.undo-done:hover{background:var(--amb-lt);}
.cfb-spacer{flex:1;}
.cfb-icon{width:30px;height:30px;padding:0;border-radius:8px;border:1.5px solid var(--border);background:transparent;color:var(--sub);cursor:pointer;transition:background 0.12s,color 0.12s,border-color 0.12s;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;}
.cfb-icon:hover{background:var(--surf3);color:var(--text);}
.cfb-icon.edit:hover{border-color:var(--accent);color:var(--accent);background:var(--acc-lt);}
.cfb-icon.del:hover{border-color:var(--red);color:var(--red);background:var(--red-lt);}
.cfb-icon.cancel:hover {
  border-color: var(--amber);
  color: var(--amber);
  background: var(--amb-lt);
}

.cfb-icon.restore:hover {
  border-color: var(--green);
  color: var(--green);
  background: var(--grn-lt);
}

@keyframes taskCancel {
  0% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.98); }
  100% { opacity: 0; transform: scale(0.95); }
}

.task-cancelling {
  animation: taskCancel 0.4s ease forwards;
  pointer-events: none;
}
.cfb-icon.copy:hover{border-color:var(--green);color:var(--green);background:var(--grn-lt);}
.cfb-icon.copy.copied{border-color:var(--green);color:var(--green);background:var(--grn-lt);}

/* EXPANDED CARD BODY */
.card-expanded-body{display:none;flex-direction:column;}
.task-card.expanded .card-expanded-body{display:flex;}
.task-card.expanded .card-desc-collapsed{display:none;}
.task-card.expanded .card-footer{display:none;}
.card-desc-full{margin:0 14px 12px;background:var(--surf3);border-radius:8px;padding:12px 14px;font-size:13px;color:var(--text);line-height:1;overflow:visible;border:1px solid var(--border);word-break:break-word;overflow-wrap:anywhere;white-space:pre-wrap;}
/* IMAGE STRIP */
.card-images-wrap{position:relative;margin:0 0 12px;}
.card-images{display:flex;gap:8px;padding:0 14px;overflow-x:auto;scroll-behavior:smooth;scrollbar-width:none;}
.card-images::-webkit-scrollbar{display:none;}
.card-img-thumb{width:80px;height:66px;border-radius:8px;flex-shrink:0;background:var(--surf3);border:1.5px solid var(--border);display:flex;align-items:center;justify-content:center;color:var(--sub);font-size:10px;font-weight:600;overflow:hidden;cursor:pointer;transition:border-color 0.15s;}
.card-img-thumb:hover{border-color:var(--accent);}
.card-img-thumb img{width:100%;height:100%;object-fit:cover;}
.add-img-btn{width:80px;height:66px;border-radius:8px;flex-shrink:0;background:transparent;border:1.5px dashed var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--sub);font-size:9px;font-weight:600;cursor:pointer;gap:3px;transition:border-color 0.15s;}
.add-img-btn:hover{border-color:var(--accent);color:var(--accent);}
.strip-nav{position:absolute;top:50%;transform:translateY(-50%);width:24px;height:24px;border-radius:50%;background:var(--surface);border:1.5px solid var(--border);color:var(--sub);cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:2;transition:all 0.15s;box-shadow:var(--shadow);}
.strip-nav:hover{border-color:var(--accent);color:var(--accent);}
.strip-nav.prev{left:2px;}
.strip-nav.next{right:2px;}
.strip-nav.hidden{display:none;}
.card-footer-exp{display:flex;align-items:center;gap:8px;margin:0 14px;padding:10px 0 12px;border-top:1px solid var(--border);}

/* EMPTY STATE */
.empty-state{text-align:center;padding:40px 20px;color:var(--sub);}
.empty-state svg{opacity:0.2;margin-bottom:10px;}
.empty-state h3{font-size:15px;font-weight:700;color:var(--text);margin-bottom:4px;}
.empty-state p{font-size:12px;}

/* LOADING STATE */
.loading-state{text-align:center;padding:40px 20px;color:var(--sub);}
.loading-spinner{width:32px;height:32px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.7s linear infinite;margin:0 auto 12px;}
@keyframes spin{to{transform:rotate(360deg);}}

/* COMPLETION ANIMATION */
@keyframes taskDone{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}
@keyframes checkPop{0%{transform:translate(-50%,-50%) scale(0);opacity:0}60%{transform:translate(-50%,-50%) scale(1.2);opacity:1}100%{transform:translate(-50%,-50%) scale(1);opacity:1}}
@keyframes confPop{0%{transform:translateY(0) scale(0);opacity:1}100%{transform:translateY(-36px) scale(1);opacity:0}}
.task-completing{animation:taskDone 0.5s ease;position:relative;}
.completion-chk{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);width:44px;height:44px;background:var(--green);border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:10;animation:checkPop 0.5s ease forwards;pointer-events:none;}
.completion-chk svg{width:22px;height:22px;stroke:#0f1a12;stroke-width:3;fill:none;}
.conf-p{position:absolute;width:6px;height:6px;border-radius:50%;animation:confPop 0.65s ease forwards;pointer-events:none;z-index:9;}

/* ADD/EDIT MODAL */
.overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0);display:flex;align-items:flex-end;justify-content:center;z-index:200;pointer-events:none;transition:background 0.28s ease;}
.overlay.open{background:rgba(0,0,0,0.45);pointer-events:all;}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:20px 20px 0 0;padding:22px 22px 36px;width:100%;max-width:520px;transform:translateY(100%);transition:transform 0.35s cubic-bezier(0.22,1,0.36,1);max-height:92vh;overflow-y:auto;box-shadow:0 -12px 40px rgba(0,0,0,0.22);will-change:transform;}
.overlay.open .modal{transform:translateY(0);}
.modal-handle{width:36px;height:4px;border-radius:2px;background:var(--border);margin:0 auto 18px;}
.modal-title{font-family:'Syne',sans-serif;font-size:18px;font-weight:700;margin-bottom:18px;color:var(--text);}
.form-group{margin-bottom:13px;}
.form-label{display:block;font-size:11px;font-weight:700;letter-spacing:0.07em;text-transform:uppercase;color:var(--sub);margin-bottom:5px;}
.form-control{width:100%;background:var(--surf2);border:1.5px solid var(--border);border-radius:10px;padding:9px 13px;font-family:'Outfit',sans-serif;font-size:14px;color:var(--text);outline:none;transition:border-color 0.15s;}
.form-control:focus{border-color:var(--accent);}
.form-control::placeholder{color:var(--sub);}
textarea.form-control{resize:vertical;min-height:70px;}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.form-actions{display:flex;gap:10px;margin-top:16px;}
.btn-cancel{flex:1;background:var(--surf2);border:1.5px solid var(--border);border-radius:10px;padding:11px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;color:var(--sub);cursor:pointer;transition:all 0.15s;}
.btn-cancel:hover{color:var(--text);border-color:var(--text);}
.btn-save{flex:2;background:var(--accent);border:none;border-radius:10px;padding:11px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:700;color:#fff;cursor:pointer;transition:opacity 0.15s;}
.btn-save:hover{opacity:0.88;}

/* ADMIN LOGIN MODAL */
.login-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.55);display:flex;align-items:center;justify-content:center;z-index:300;opacity:0;pointer-events:none;transition:opacity 0.25s;}
.login-overlay.open{opacity:1;pointer-events:all;}
.login-modal{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:28px 28px 26px;width:calc(100% - 32px);max-width:380px;transform:scale(0.95) translateY(8px);transition:transform 0.25s ease,opacity 0.25s;box-shadow:0 20px 60px rgba(0,0,0,0.25);}
.login-overlay.open .login-modal{transform:scale(1) translateY(0);}
.login-header{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:24px;}
.login-icon{width:52px;height:52px;border-radius:16px;background:var(--acc-lt);border:1.5px solid var(--accent);display:flex;align-items:center;justify-content:center;color:var(--accent);}
.login-title{font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:var(--text);}
.login-sub{font-size:12px;color:var(--sub);text-align:center;}
.login-form-group{margin-bottom:12px;}
.login-label{display:block;font-size:11px;font-weight:700;letter-spacing:0.07em;text-transform:uppercase;color:var(--sub);margin-bottom:5px;}
.login-input{width:100%;background:var(--surf2);border:1.5px solid var(--border);border-radius:10px;padding:10px 13px;font-family:'Outfit',sans-serif;font-size:14px;color:var(--text);outline:none;transition:border-color 0.15s;}
.login-input:focus{border-color:var(--accent);}
.login-input::placeholder{color:var(--sub);}
.login-error{font-size:11px;color:var(--red);background:var(--red-lt);border:1px solid rgba(220,38,38,0.2);border-radius:8px;padding:8px 12px;margin-bottom:12px;display:none;align-items:center;gap:6px;}
.login-error.show{display:flex;}
.login-actions{display:flex;gap:10px;margin-top:16px;}
.btn-login-cancel{flex:1;background:var(--surf2);border:1.5px solid var(--border);border-radius:10px;padding:11px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;color:var(--sub);cursor:pointer;transition:all 0.15s;}
.btn-login-cancel:hover{color:var(--text);border-color:var(--text);}
.btn-login-go{flex:2;background:var(--accent);border:none;border-radius:10px;padding:11px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:700;color:#fff;cursor:pointer;transition:opacity 0.15s;}
.btn-login-go:hover{opacity:0.88;}
.shake{animation:shake 0.38s ease;}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-5px)}40%{transform:translateX(5px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}

/* LIGHTBOX */
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,0.92);z-index:500;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.2s;}
.lightbox.open{opacity:1;pointer-events:all;}
.lightbox img{max-width:88vw;max-height:82vh;border-radius:10px;object-fit:contain;user-select:none;}
.lb-close{position:absolute;top:16px;right:18px;background:rgba(255,255,255,0.12);border:none;color:#fff;width:36px;height:36px;border-radius:50%;font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.15s;z-index:10;}
.lb-close:hover{background:rgba(255,255,255,0.25);}
.lb-nav{position:absolute;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,0.12);border:none;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.15s;z-index:10;}
.lb-nav:hover{background:rgba(255,255,255,0.28);}
.lb-prev{left:16px;}
.lb-next{right:16px;}
.lb-counter{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);color:rgba(255,255,255,0.75);font-size:12px;font-weight:700;letter-spacing:0.05em;pointer-events:none;}
.lb-del{position:absolute;top:16px;left:18px;background:rgba(220,38,38,0.7);border:none;color:#fff;width:36px;height:36px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.15s;z-index:10;}
.lb-del:hover{background:rgba(220,38,38,1);}
.lb-del-wrap{display:none;}
.lb-del-wrap.admin-visible{display:block;}

/* DELETE CONFIRM MODAL */
.del-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:400;opacity:0;pointer-events:none;transition:opacity 0.2s;}
.del-overlay.open{opacity:1;pointer-events:all;}
#photoDelOverlay{z-index:600;}
.del-modal{background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:28px 26px 24px;width:calc(100% - 40px);max-width:320px;text-align:center;transform:scale(0.92) translateY(8px);transition:transform 0.22s ease;box-shadow:0 20px 60px rgba(0,0,0,0.22);will-change:transform;}
.del-overlay.open .del-modal{transform:scale(1) translateY(0);}
.del-icon{width:52px;height:52px;border-radius:14px;background:var(--red-lt);border:1.5px solid rgba(220,38,38,0.25);display:flex;align-items:center;justify-content:center;color:var(--red);margin:0 auto 14px;}
.del-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;color:var(--text);margin-bottom:6px;}
.del-sub{font-size:12px;color:var(--sub);margin-bottom:22px;line-height:1.5;}
.del-actions{display:flex;gap:10px;}
.del-btn-cancel{flex:1;background:var(--surf2);border:1.5px solid var(--border);border-radius:10px;padding:10px;font-family:'Outfit',sans-serif;font-size:13px;font-weight:600;color:var(--sub);cursor:pointer;transition:all 0.15s;}
.del-btn-cancel:hover{color:var(--text);border-color:var(--text);}
.del-btn-confirm{flex:1;background:var(--red);border:none;border-radius:10px;padding:10px;font-family:'Outfit',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;transition:opacity 0.15s;}
.del-btn-confirm:hover{opacity:0.85;}

/* CREDITS WATERMARK */
.credits-badge{position:fixed;bottom:14px;right:16px;font-family:'Syne',sans-serif;font-size:10px;font-weight:700;letter-spacing:0.08em;color:var(--sub);opacity:0.38;pointer-events:none;user-select:none;z-index:50;}
body.dark .credits-badge{opacity:0.22;}

input[type=file]{display:none;}

/* ── NOTIFICATION BELL ───────────────────────────────────────── */
.notif-bell {
  position: relative;
  flex-shrink: 0;
  display: flex !important;
}

.notif-bell:not(.notif-on):not(.notif-denied) {
  border-color: var(--border);
  color: var(--sub);
}

.notif-bell.notif-on {
  border-color: var(--accent);
  color: var(--accent);
  background: var(--acc-lt);
}

/* Active dot uses ::before — keeps ::after free for the arrow */
.notif-bell.notif-on::before {
  content: '';
  position: absolute;
  top: 5px; right: 5px;
  width: 6px; height: 6px;
  background: var(--accent);
  border-radius: 50%;
  border: 1.5px solid var(--surface);
  pointer-events: none;
  z-index: 2;
}

.notif-bell.notif-denied {
  border-color: var(--red);
  color: var(--red);
  background: var(--red-lt);
  opacity: 0.65;
}

.notif-bell.notif-denied::before,
.notif-bell.notif-denied::after {
  display: none !important;
}

.notif-bell.notif-on::after,
.notif-bell.notif-subscribed::after {
  display: none !important;
}

@keyframes bellPulse {
  0%,100% { transform: rotate(0deg); }
  20%      { transform: rotate(-12deg); }
  40%      { transform: rotate(12deg); }
  60%      { transform: rotate(-8deg); }
  80%      { transform: rotate(8deg); }
}
.notif-bell:hover svg {
  animation: bellPulse 0.5s ease;
}

/* ── NOTIFICATION TOAST ──────────────────────────────────────── */
.notif-toast {
  position: fixed;
  bottom: -80px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 10px 18px;
  font-family: 'Outfit', sans-serif;
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  box-shadow: 0 8px 32px rgba(0,0,0,0.18);
  white-space: nowrap;
  z-index: 9999;
  transition: bottom 0.35s cubic-bezier(0.22,1,0.36,1), opacity 0.3s;
  opacity: 0;
  max-width: calc(100vw - 32px);
  overflow: hidden;
  text-overflow: ellipsis;
}
.notif-toast.show {
  bottom: 28px;
  opacity: 1;
}
.notif-toast-success { border-color: var(--green); color: var(--green); background: var(--grn-lt); }
.notif-toast-error   { border-color: var(--red);   color: var(--red);   background: var(--red-lt); }
.notif-toast-warn    { border-color: var(--amber);  color: var(--amber); background: var(--amb-lt); }
.notif-toast-info    { border-color: var(--accent); color: var(--accent); background: var(--acc-lt); }

/* ── BELL POINTER ANIMATION ──────────────────────────────────── */
/* Arrow only shows when unsubscribed AND not denied */
.notif-bell:not(.notif-on):not(.notif-subscribed):not(.notif-denied)::after {
  content: '';
  position: absolute;
  bottom: -22px;
  left: 50%;
  transform: translateX(-50%);
  width: 16px;
  height: 16px;
  background-repeat: no-repeat;
  background-size: contain;
  background-position: center;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%235b52e8' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='12' y1='19' x2='12' y2='5'/%3E%3Cpolyline points='5 12 12 5 19 12'/%3E%3C/svg%3E");
  animation: pointerBounce 1s ease-in-out infinite;
  pointer-events: none;
  z-index: 1;
}

@keyframes pointerBounce {
  0%, 100% { transform: translateX(-50%) translateY(0);    opacity: 1;   }
  50%      { transform: translateX(-50%) translateY(-5px); opacity: 0.6; }
}

/* ── HELP FAB BUTTON ────────────────────────────────── */
.help-fab {
  position: fixed;
  bottom: 20px;
  left: 20px;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: transparent;
  border: 1.5px solid var(--sub);
  color: var(--sub);
  font-family: 'Syne', sans-serif;
  font-size: 12px;
  font-weight: 800;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  z-index: 55;
  user-select: none;
  opacity: 0.38;
}
.help-fab:hover {
  opacity: 0.7;
  transform: scale(1.08);
}
body.dark .help-fab {
  opacity: 0.22;
}
body.dark .help-fab:hover {
  opacity: 0.5;
}

/* ── HELP OVERLAY ───────────────────────────────────── */
.help-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  display: flex;
  align-items: flex-end;
  justify-content: center;
  z-index: 250;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.28s ease;
}
.help-overlay.open {
  opacity: 1;
  pointer-events: all;
}

/* ── HELP MODAL ─────────────────────────────────────── */
.help-modal {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px 20px 0 0;
  width: 100%;
  max-width: 540px;
  max-height: 85vh;
  display: flex;
  flex-direction: column;
  transform: translateY(100%);
  transition: transform 0.35s cubic-bezier(0.22,1,0.36,1);
  box-shadow: 0 -12px 40px rgba(0,0,0,0.18);
  overflow: hidden;
}
.help-overlay.open .help-modal {
  transform: translateY(0);
}

/* ── HEADER ─────────────────────────────────────────── */
.help-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 20px 14px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.help-modal-title {
  font-family: 'Syne', sans-serif;
  font-size: 16px;
  font-weight: 800;
  color: var(--text);
  display: flex;
  align-items: center;
  gap: 8px;
}
.help-modal-title svg {
  color: var(--accent);
  flex-shrink: 0;
}
.help-close-btn {
  width: 30px;
  height: 30px;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: var(--surf2);
  color: var(--sub);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
  flex-shrink: 0;
}
.help-close-btn:hover {
  border-color: var(--red);
  color: var(--red);
  background: var(--red-lt);
}

/* ── BODY ───────────────────────────────────────────── */
.help-body {
  overflow-y: auto;
  padding: 16px 20px 36px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* ── SECTIONS ───────────────────────────────────────── */
.help-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.help-section-title {
  font-family: 'Syne', sans-serif;
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--text);
  display: flex;
  align-items: center;
  gap: 7px;
}
.help-section-icon {
  color: var(--accent);
  flex-shrink: 0;
}
.help-desc {
  font-size: 13px;
  color: var(--sub);
  line-height: 1.6;
  background: var(--surf2);
  border-radius: 10px;
  padding: 10px 13px;
  border: 1px solid var(--border);
}
.help-desc strong {
  color: var(--text);
  font-weight: 700;
}
.help-item {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 13px;
  color: var(--sub);
  padding: 1px 0;
}
.help-item strong { color: var(--text); }

/* ── FILTER BADGES ──────────────────────────────────── */
.help-badge {
  font-size: 10px;
  font-weight: 700;
  padding: 3px 10px;
  border-radius: 20px;
  white-space: nowrap;
  flex-shrink: 0;
  letter-spacing: 0.03em;
}
.badge-all     { background: var(--acc-lt); color: var(--accent); border: 1px solid var(--accent); }
.badge-soon    { background: var(--amb-lt); color: var(--amber);  border: 1px solid var(--amber); }
.badge-today   { background: rgba(234,107,14,0.12); color: #ea6b0e; border: 1px solid #ea6b0e; }
.badge-overdue { background: var(--red-lt); color: var(--red);   border: 1px solid var(--red); }
.badge-done    { background: var(--grn-lt); color: var(--green); border: 1px solid var(--green); }

.badge-cancelled {
  background: rgba(107, 116, 128, 0.12);
  color: #6b7280;
  border: 1px solid #6b7280;
}

body.dark .badge-cancelled {
  background: rgba(107, 116, 128, 0.18);
  color: #9ca3af;
  border-color: #9ca3af;
}

/* ── SYNC DOTS ──────────────────────────────────────── */
.help-sync-dot {
  width: 9px;
  height: 9px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* ── FOOTER NOTE ────────────────────────────────────── */
.help-footer-note {
  font-size: 12px;
  color: var(--sub);
  background: var(--grn-lt);
  border: 1px solid rgba(22,163,90,0.25);
  border-radius: 10px;
  padding: 10px 13px;
  line-height: 1.55;
  display: flex;
  align-items: flex-start;
  gap: 8px;
}
.help-footer-note svg { color: var(--green); }
.help-footer-note strong { color: var(--green); }

/* ── ACTIVE FILTER ─────────────────────────────────────────── */
.f-active .f-dot { background: #0ea5e9; }
.filter-btn.active.f-active {
  background: rgba(14,165,233,0.12);
  border-color: #0ea5e9;
  color: #0ea5e9;
}
.filter-btn.active.f-active .filter-count {
  background: rgba(0,0,0,0.10);
  color: inherit;
}
body.dark .filter-btn.active.f-active .filter-count {
  background: rgba(255,255,255,0.12);
}

/* ── ACTIVE BADGE IN HELP MODAL ────────────────────────────── */
.badge-active {
  background: rgba(14,165,233,0.12);
  color: #0ea5e9;
  border: 1px solid #0ea5e9;
}
body.dark .badge-active {
  background: rgba(14,165,233,0.18);
  color: #38bdf8;
  border-color: #38bdf8;
}

/* ── DAILY TIP ──────────────────────────────────────────────── */
.daily-tip {
  margin-top: 8px;
  padding: 9px 9px 7px;
  border-radius: 9px;
  background: transparent;
  border: 1px solid var(--border);
  font-size: 10px;
  color: var(--sub);
  line-height: 1.55;
  word-break: break-word;
}
.daily-tip-label {
  font-family: 'Syne', sans-serif;
  font-size: 9px;
  font-weight: 800;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 4px;
  display: block;
}
